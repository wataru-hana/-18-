
import sys
import os
import re

# app.pyからMATERIAL_MAPPINGをインポートしたいが、依存関係があるので直接定義
MATERIAL_MAPPING = {
    # ピカ銅
    'ピカ銅': 'ピカ銅', 'ピカ線': 'ピカ銅', 'ピカドウ': 'ピカ銅',
    '1号銅': 'ピカ銅', '一号銅': 'ピカ銅', '特一号銅': 'ピカ銅',
    '上銅': 'ピカ銅',  # 土金
    
    # 並銅
    '並銅': '並銅', '波銅': '並銅', '波道': '並銅', '2号銅': '並銅',
    '込銅': '並銅',  # 鴻祥貿易
    
    # 砲金
    '砲金': '砲金', 'ほうきん': '砲金', 'gunmetal': '砲金',
    
    # 真鍮
    '真鍮': '真鍮', 'しんちゅう': '真鍮', '黄銅': '真鍮',
    '真鍮A': '真鍮',  # 東起産業
    '真鍮（上）': '真鍮',  # 土金
    '真鍮B': '真鍮',  # 鴻祥貿易
    
    # 雑線80%
    '雑線80%': '雑線80%', '雑電線80%': '雑線80%', '電線80%': '雑線80%', '雑線（80%）': '雑線80%',
    '一本線80%': '雑線80%',  # 東起産業
    '雑線S': '雑線80%',  # 土金
    '上線': '雑線80%',  # 鴻祥貿易
    '上線銅率80%': '雑線80%',  # 鴻祥貿易
    
    # 雑線60%-65%
    '雑線60%': '雑60%-65%', '雑線65%': '雑60%-65%', '雑線60%-65%': '雑60%-65%',
    '雑電線60%': '雑60%-65%', '電線60%': '雑60%-65%', '雑線（60%）': '雑60%-65%',
    '雑60%-65%': '雑60%-65%',
    '三本線65%': '雑60%-65%',  # 東起産業
    '雑線A': '雑60%-65%',  # 土金
    '上線銅率60%': '雑60%-65%',  # 鴻祥貿易
    
    # VA線
    'VA線': 'VA線', 'VVF': 'VA線', 'VVFケーブル': 'VA線', 'ＶＡ線': 'VA線',
    'ＶＡ線(巻き)': 'VA線',  # 土金
    'ねずみ線': 'VA線',  # 鴻祥貿易
    
    # アルミホイール
    'アルミホイール': 'アルミホイール', 'ホイール': 'アルミホイール', 'Alホイール': 'アルミホイール',
    
    # アルミサッシ
    'アルミサッシ': 'アルミサッシ', 'サッシ': 'アルミサッシ', 'Alサッシ': 'アルミサッシ',
    'アルミサッシA 付物なし': 'アルミサッシ',  # 東起産業
    'アルミサッシA': 'アルミサッシ',  # 鴻祥貿易
    'アルミ（上）': 'アルミサッシ',  # 土金
    
    # アルミ缶
    'アルミ缶': 'アルミ缶', 'アルミ缶バラ': 'アルミ缶', '缶バラ': 'アルミ缶', 'アルミ缶　バラ': 'アルミ缶',
    'バラアルミ缶': 'アルミ缶', 'アルミ缶プレス': 'アルミ缶', '缶プレス': 'アルミ缶', 'アルミ缶　プレス': 'アルミ缶',
    'アルミ缶（プレス）': 'アルミ缶',  # 土金
    
    # ステンレス304
    'SUS304': 'ステンレス304', 'ステンレス304': 'ステンレス304', '304': 'ステンレス304',
    'ステン304': 'ステンレス304', 'SUS': 'ステンレス304', 'プレスステンレス304': 'ステンレス304',
    'ステンレス': 'ステンレス304',  # 東起産業
    'ステンレス 304': 'ステンレス304',  # 鴻祥貿易
    'ステンレス（上）': 'ステンレス304',  # 土金
    
    # 鉛バッテリー
    '鉛バッテリー': '鉛バッテリー', 'バッテリー': '鉛バッテリー', '鉛': '鉛バッテリー',
    '自動車バッテリー': '鉛バッテリー',  # 東起産業
    'バッテリー（上）': '鉛バッテリー',  # 土金
}

def normalize_material(material_name):
    # 材料名を正規化（より具体的なマッピングを優先）
    normalized_material = None
    best_match_length = 0
    
    for key, value in MATERIAL_MAPPING.items():
        if key in material_name or material_name in key:
            # より長いマッチを優先（より具体的なマッピング）
            match_length = len(key) if key in material_name else len(material_name)
            if match_length > best_match_length:
                normalized_material = value
                best_match_length = match_length
    
    return normalized_material

# テストケース
test_cases = [
    # 東起産業
    ('真鍮A', '真鍮'),
    ('三本線65%', '雑60%-65%'),
    ('アルミサッシA 付物なし', 'アルミサッシ'),
    ('ステンレス', 'ステンレス304'),
    
    # 土金
    ('砲金', '砲金'),
    ('雑線A', '雑60%-65%'),
    ('アルミ（上）', 'アルミサッシ'),
    ('アルミ缶', 'アルミ缶'),
    ('ステンレス（上）', 'ステンレス304'),
    ('バッテリー（上）', '鉛バッテリー'),
    
    # 鴻祥貿易
    ('上線銅率80%', '雑線80%'),
    ('上線銅率60%', '雑60%-65%'),
    ('アルミサッシA', 'アルミサッシ'),
    ('ステンレス 304', 'ステンレス304'),
    ('バッテリー', '鉛バッテリー'),
]

print('=== マッピングテスト ===')
failed = False
for material, expected in test_cases:
    result = normalize_material(material)
    if result != expected:
        print(f'FAIL: {material} -> {result} (Expected: {expected})')
        failed = True
    else:
        print(f'PASS: {material} -> {result}')

if not failed:
    print('すべてのテストが成功しました！')









